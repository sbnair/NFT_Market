{"ast":null,"code":"import _objectSpread from\"/home/ubuntu/NFT_Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/ubuntu/NFT_Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ubuntu/NFT_Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ubuntu/NFT_Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/home/ubuntu/NFT_Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4;import{useEffect,useState}from\"react\";import styled from\"styled-components\";import Countdown from\"react-countdown\";import{Button,CircularProgress,Snackbar}from\"@material-ui/core\";import Alert from\"@material-ui/lab/Alert\";import{LAMPORTS_PER_SOL}from\"@solana/web3.js\";import{useAnchorWallet}from\"@solana/wallet-adapter-react\";import{WalletDialogButton}from\"@solana/wallet-adapter-material-ui\";import{awaitTransactionSignatureConfirmation,getCandyMachineState,mintOneToken,shortenAddress}from\"./test_script\";import Skeleton from\"./logo.svg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ConnectButton=styled(WalletDialogButton)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\"])));var CounterText=styled.span(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\"])));// add your styles here\nvar MintContainer=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\"])));// add your styles here\nvar MintButton=styled(Button)(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\"])));// add your styles here\nvar indexes=[1,2,3,4,5,6,7,8,9,10,11,12];var items=[{name:'1'},{name:'2'},{name:'3'},{name:'4'},{name:'5'},{name:'6'},{name:'7'},{name:'8'},{name:'9'},{name:'10'},{name:'11'},{name:'12'}];var myItems=[{name:'11'},{name:'12'}];var Home=function Home(props){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),curPage=_useState2[0],setCurPage=_useState2[1];var _useState3=useState(items),_useState4=_slicedToArray(_useState3,2),curItems=_useState4[0],setCurItems=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),balance=_useState6[0],setBalance=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isActive=_useState8[0],setIsActive=_useState8[1];// true when countdown completes\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isSoldOut=_useState10[0],setIsSoldOut=_useState10[1];// true when items remaining is zero\nvar _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isMinting=_useState12[0],setIsMinting=_useState12[1];// true when user got to press MINT\nvar _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),itemsAvailable=_useState14[0],setItemsAvailable=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),itemsRedeemed=_useState16[0],setItemsRedeemed=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),itemsRemaining=_useState18[0],setItemsRemaining=_useState18[1];var _useState19=useState({open:false,message:\"\",severity:undefined}),_useState20=_slicedToArray(_useState19,2),alertState=_useState20[0],setAlertState=_useState20[1];var _useState21=useState(new Date(props.startDate)),_useState22=_slicedToArray(_useState21,2),startDate=_useState22[0],setStartDate=_useState22[1];var wallet=useAnchorWallet();var _useState23=useState(),_useState24=_slicedToArray(_useState23,2),candyMachine=_useState24[0],setCandyMachine=_useState24[1];var refreshCandyMachineState=function refreshCandyMachineState(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$getCandyMachin,candyMachine,goLiveDate,itemsAvailable,itemsRemaining,itemsRedeemed;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(wallet){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.next=4;return getCandyMachineState(wallet,props.candyMachineId,props.connection);case 4:_yield$getCandyMachin=_context.sent;candyMachine=_yield$getCandyMachin.candyMachine;goLiveDate=_yield$getCandyMachin.goLiveDate;itemsAvailable=_yield$getCandyMachin.itemsAvailable;itemsRemaining=_yield$getCandyMachin.itemsRemaining;itemsRedeemed=_yield$getCandyMachin.itemsRedeemed;setItemsAvailable(itemsAvailable);setItemsRemaining(itemsRemaining);setItemsRedeemed(itemsRedeemed);setIsSoldOut(itemsRemaining===0);setStartDate(goLiveDate);setCandyMachine(candyMachine);case 16:case\"end\":return _context.stop();}}},_callee);}))();};var onMint=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var mintTxId,status,message,_balance;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setIsMinting(true);if(!(wallet&&(candyMachine===null||candyMachine===void 0?void 0:candyMachine.program))){_context2.next=10;break;}_context2.next=5;return mintOneToken(candyMachine,props.config,wallet.publicKey,props.treasury);case 5:mintTxId=_context2.sent;_context2.next=8;return awaitTransactionSignatureConfirmation(mintTxId,props.txTimeout,props.connection,\"singleGossip\",false);case 8:status=_context2.sent;if(!(status===null||status===void 0?void 0:status.err)){setAlertState({open:true,message:\"Congratulations! Mint succeeded!\",severity:\"success\"});}else{setAlertState({open:true,message:\"Mint failed! Please try again!\",severity:\"error\"});}case 10:_context2.next=17;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](0);// TODO: blech:\nmessage=_context2.t0.msg||\"Minting failed! Please try again!\";if(!_context2.t0.msg){if(_context2.t0.message.indexOf(\"0x138\")){}else if(_context2.t0.message.indexOf(\"0x137\")){message=\"SOLD OUT!\";}else if(_context2.t0.message.indexOf(\"0x135\")){message=\"Insufficient funds to mint. Please fund your wallet.\";}}else{if(_context2.t0.code===311){message=\"SOLD OUT!\";setIsSoldOut(true);}else if(_context2.t0.code===312){message=\"Minting period hasn't started yet.\";}}setAlertState({open:true,message:message,severity:\"error\"});case 17:_context2.prev=17;if(!wallet){_context2.next=23;break;}_context2.next=21;return props.connection.getBalance(wallet.publicKey);case 21:_balance=_context2.sent;setBalance(_balance/LAMPORTS_PER_SOL);case 23:setIsMinting(false);refreshCandyMachineState();return _context2.finish(17);case 26:case\"end\":return _context2.stop();}}},_callee2,null,[[0,12,17,26]]);}));return function onMint(){return _ref2.apply(this,arguments);};}();useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _balance2;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!wallet){_context3.next=7;break;}_context3.next=3;return props.connection.getBalance(wallet.publicKey);case 3:_balance2=_context3.sent;setBalance(_balance2/LAMPORTS_PER_SOL);_context3.next=9;break;case 7:setCurItems(curItems);setCurPage(0);case 9:case\"end\":return _context3.stop();}}},_callee3);}))();},[wallet,props.connection]);useEffect(refreshCandyMachineState,[wallet,props.candyMachineId,props.connection]);return/*#__PURE__*/_jsxs(\"main\",{style:{position:'relative'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',display:'flex',flexDirection:'row',justifyContent:'center',minHeight:100},children:[wallet&&/*#__PURE__*/_jsx(\"span\",{style:{width:80,cursor:'pointer',margin:20},onClick:function onClick(){setCurPage(0);setCurItems(items);},children:\"Home\"}),wallet&&/*#__PURE__*/_jsx(\"span\",{style:{width:80,cursor:'pointer',margin:20},onClick:function onClick(){setCurPage(1);setCurItems(myItems);},children:\"My heroes\"})]}),wallet&&/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',display:'flex',flexDirection:'row',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Total Available: \",itemsAvailable]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Redeemed: \",itemsRedeemed]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Remaining: \",itemsRemaining]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Wallet \",shortenAddress(wallet.publicKey.toBase58()||\"\")]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Balance: \",(balance||0).toLocaleString(),\" SOL\"]})]})]}),/*#__PURE__*/_jsx(MintContainer,{children:!wallet?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ConnectButton,{style:{position:'absolute',right:0,top:0},children:\"Connect Wallet\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',display:'flex',flexDirection:'row',flexWrap:'wrap',justifyContent:'center',maxWidth:1100},children:indexes.map(function(item,idx){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',justifyContent:'flex-start',width:200,margin:30},children:[/*#__PURE__*/_jsx(\"div\",{style:{position:'relative',backgroundColor:'rgba(50, 50, 0, 0.5)'},children:/*#__PURE__*/_jsx(\"img\",{alt:'back'+idx,src:Skeleton,width:200,height:200,style:{backgroundColor:'rgba(50, 50, 0, 0.5)',zIndex:-1}})}),/*#__PURE__*/_jsx(MintButton,{disabled:true,onClick:onMint,variant:\"contained\",children:\"MINT\"})]});})})]}):/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',display:'flex',flexDirection:'row',flexWrap:'wrap',justifyContent:'center',maxWidth:1100},children:curItems.map(function(item,idx){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',justifyContent:'flex-start',width:200,margin:30},children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',backgroundColor:'rgba(50, 50, 0, 0.5)'},children:[/*#__PURE__*/_jsx(\"img\",{alt:''+idx,src:\"https://placeimg.com/200/200/\"+idx,style:{minWidth:200,minHeight:200,zIndex:1}}),/*#__PURE__*/_jsx(\"img\",{alt:'back'+idx,src:Skeleton,width:200,height:200,style:{position:'absolute',top:0,left:0,backgroundColor:'rgba(50, 50, 0, 0.5)',zIndex:-1}})]}),/*#__PURE__*/_jsx(MintButton,{disabled:isSoldOut||isMinting||!isActive,onClick:onMint,variant:\"contained\",children:isSoldOut?\"SOLD OUT\":isActive?isMinting?/*#__PURE__*/_jsx(CircularProgress,{}):\"MINT\":/*#__PURE__*/_jsx(Countdown,{date:startDate,onMount:function onMount(_ref4){var completed=_ref4.completed;return completed&&setIsActive(true);},onComplete:function onComplete(){return setIsActive(true);},renderer:renderCounter})})]});})})}),/*#__PURE__*/_jsx(Snackbar,{open:alertState.open,autoHideDuration:6000,onClose:function onClose(){return setAlertState(_objectSpread(_objectSpread({},alertState),{},{open:false}));},children:/*#__PURE__*/_jsx(Alert,{onClose:function onClose(){return setAlertState(_objectSpread(_objectSpread({},alertState),{},{open:false}));},severity:alertState.severity,children:alertState.message})})]});};var renderCounter=function renderCounter(_ref5){var days=_ref5.days,hours=_ref5.hours,minutes=_ref5.minutes,seconds=_ref5.seconds,completed=_ref5.completed;return/*#__PURE__*/_jsxs(CounterText,{children:[hours+(days||0)*24,\" hours, \",minutes,\" minutes, \",seconds,\" seconds\"]});};export default Home;","map":{"version":3,"sources":["/home/ubuntu/NFT_Project/src/Home.tsx"],"names":["useEffect","useState","styled","Countdown","Button","CircularProgress","Snackbar","Alert","LAMPORTS_PER_SOL","useAnchorWallet","WalletDialogButton","awaitTransactionSignatureConfirmation","getCandyMachineState","mintOneToken","shortenAddress","ConnectButton","CounterText","span","MintContainer","div","MintButton","indexes","items","name","myItems","Home","props","curPage","setCurPage","curItems","setCurItems","balance","setBalance","isActive","setIsActive","isSoldOut","setIsSoldOut","isMinting","setIsMinting","itemsAvailable","setItemsAvailable","itemsRedeemed","setItemsRedeemed","itemsRemaining","setItemsRemaining","open","message","severity","undefined","alertState","setAlertState","Date","startDate","setStartDate","wallet","candyMachine","setCandyMachine","refreshCandyMachineState","candyMachineId","connection","goLiveDate","onMint","program","config","publicKey","treasury","mintTxId","txTimeout","status","err","msg","indexOf","code","getBalance","position","width","display","flexDirection","justifyContent","minHeight","cursor","margin","toBase58","toLocaleString","right","top","flexWrap","maxWidth","map","item","idx","backgroundColor","Skeleton","zIndex","minWidth","left","completed","renderCounter","days","hours","minutes","seconds"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport Countdown from \"react-countdown\";\nimport { Button, CircularProgress, Snackbar } from \"@material-ui/core\";\nimport Alert from \"@material-ui/lab/Alert\";\n\nimport * as anchor from \"@project-serum/anchor\";\n\nimport { LAMPORTS_PER_SOL } from \"@solana/web3.js\";\n\nimport { useAnchorWallet } from \"@solana/wallet-adapter-react\";\nimport { WalletDialogButton } from \"@solana/wallet-adapter-material-ui\";\n\nimport {\n  CandyMachine,\n  awaitTransactionSignatureConfirmation,\n  getCandyMachineState,\n  mintOneToken,\n  shortenAddress,\n} from \"./test_script\";\n\nimport Skeleton from './logo.svg';\nimport { randomBytes } from \"crypto\";\n\nconst ConnectButton = styled(WalletDialogButton)``;\n\nconst CounterText = styled.span``; // add your styles here\n\nconst MintContainer = styled.div``; // add your styles here\n\nconst MintButton = styled(Button)``; // add your styles here\n\nexport interface HomeProps {\n  candyMachineId: anchor.web3.PublicKey;\n  config: anchor.web3.PublicKey;\n  connection: anchor.web3.Connection;\n  startDate: number;\n  treasury: anchor.web3.PublicKey;\n  txTimeout: number;\n}\n\ninterface NFTItem {\n  name: string;\n}\n\nconst indexes = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n\nconst items = [\n  {name: '1'},\n  {name: '2'},\n  {name: '3'},\n  {name: '4'},\n  {name: '5'},\n  {name: '6'},\n  {name: '7'},\n  {name: '8'},\n  {name: '9'},\n  {name: '10'},\n  {name: '11'},\n  {name: '12'},\n];\nconst myItems = [\n  {name: '11'},\n  {name: '12'},\n];\n\nconst Home = (props: HomeProps) => {\n  const [curPage, setCurPage] = useState(0);\n  const [curItems, setCurItems] = useState<NFTItem[]>(items);\n  const [balance, setBalance] = useState<number>();\n  const [isActive, setIsActive] = useState(false); // true when countdown completes\n  const [isSoldOut, setIsSoldOut] = useState(false); // true when items remaining is zero\n  const [isMinting, setIsMinting] = useState(false); // true when user got to press MINT\n\n  const [itemsAvailable, setItemsAvailable] = useState(0);\n  const [itemsRedeemed, setItemsRedeemed] = useState(0);\n  const [itemsRemaining, setItemsRemaining] = useState(0);\n\n  const [alertState, setAlertState] = useState<AlertState>({\n    open: false,\n    message: \"\",\n    severity: undefined,\n  });\n\n  const [startDate, setStartDate] = useState(new Date(props.startDate));\n\n  const wallet = useAnchorWallet();\n  const [candyMachine, setCandyMachine] = useState<CandyMachine>();\n\n  const refreshCandyMachineState = () => {\n    (async () => {\n      if (!wallet) return;\n\n      const {\n        candyMachine,\n        goLiveDate,\n        itemsAvailable,\n        itemsRemaining,\n        itemsRedeemed,\n      } = await getCandyMachineState(\n        wallet as anchor.Wallet,\n        props.candyMachineId,\n        props.connection\n      );\n\n      setItemsAvailable(itemsAvailable);\n      setItemsRemaining(itemsRemaining);\n      setItemsRedeemed(itemsRedeemed);\n\n      setIsSoldOut(itemsRemaining === 0);\n      setStartDate(goLiveDate);\n      setCandyMachine(candyMachine);\n    })();\n  };\n\n  const onMint = async () => {\n    try {\n      setIsMinting(true);\n      if (wallet && candyMachine?.program) {\n        const mintTxId = await mintOneToken(\n          candyMachine,\n          props.config,\n          wallet.publicKey,\n          props.treasury\n        );\n\n        const status = await awaitTransactionSignatureConfirmation(\n          mintTxId,\n          props.txTimeout,\n          props.connection,\n          \"singleGossip\",\n          false\n        );\n\n        if (!status?.err) {\n          setAlertState({\n            open: true,\n            message: \"Congratulations! Mint succeeded!\",\n            severity: \"success\",\n          });\n        } else {\n          setAlertState({\n            open: true,\n            message: \"Mint failed! Please try again!\",\n            severity: \"error\",\n          });\n        }\n      }\n    } catch (error: any) {\n      // TODO: blech:\n      let message = error.msg || \"Minting failed! Please try again!\";\n      if (!error.msg) {\n        if (error.message.indexOf(\"0x138\")) {\n        } else if (error.message.indexOf(\"0x137\")) {\n          message = `SOLD OUT!`;\n        } else if (error.message.indexOf(\"0x135\")) {\n          message = `Insufficient funds to mint. Please fund your wallet.`;\n        }\n      } else {\n        if (error.code === 311) {\n          message = `SOLD OUT!`;\n          setIsSoldOut(true);\n        } else if (error.code === 312) {\n          message = `Minting period hasn't started yet.`;\n        }\n      }\n\n      setAlertState({\n        open: true,\n        message,\n        severity: \"error\",\n      });\n    } finally {\n      if (wallet) {\n        const balance = await props.connection.getBalance(wallet.publicKey);\n        setBalance(balance / LAMPORTS_PER_SOL);\n      }\n      setIsMinting(false);\n      refreshCandyMachineState();\n    }\n  };\n\n  useEffect(() => {\n    (async () => {\n      if (wallet) {\n        const balance = await props.connection.getBalance(wallet.publicKey);\n        setBalance(balance / LAMPORTS_PER_SOL);\n      } else {\n        setCurItems(curItems);\n        setCurPage(0);\n      }\n    })();\n  }, [wallet, props.connection]);\n\n  useEffect(refreshCandyMachineState, [\n    wallet,\n    props.candyMachineId,\n    props.connection,\n  ]);\n\n  return (\n    <main style={{position: 'relative'}}>\n      <div style={{\n        width: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'center',\n        minHeight: 100,\n      }}\n      >\n        {wallet && <span style={{width: 80, cursor: 'pointer', margin: 20}} onClick={() => {\n          setCurPage(0);\n          setCurItems(items);\n        }}>Home</span>}\n        {wallet && <span style={{width: 80, cursor: 'pointer', margin: 20}} onClick={() => {\n          setCurPage(1);\n          setCurItems(myItems);\n        }}>My heroes</span>}\n      </div>\n      {wallet && (\n        <div style={{width: '100%', display: 'flex', flexDirection: 'row', justifyContent: 'space-between'}}>\n          <div>\n            <p>Total Available: {itemsAvailable}</p>\n            <p>Redeemed: {itemsRedeemed}</p>\n            <p>Remaining: {itemsRemaining}</p>\n          </div>\n          <div>\n            <p>Wallet {shortenAddress(wallet.publicKey.toBase58() || \"\")}</p>\n            <p>Balance: {(balance || 0).toLocaleString()} SOL</p>\n          </div>\n        </div>\n      )}\n\n      <MintContainer>\n        {!wallet ? (\n          <>\n          <ConnectButton style={{position: 'absolute', right: 0, top: 0}}>Connect Wallet</ConnectButton>\n          <div style={{\n            width: '100%',\n            display: 'flex',\n            flexDirection: 'row',\n            flexWrap: 'wrap',\n            justifyContent: 'center',\n            maxWidth: 1100\n          }}>\n            { indexes.map((item, idx) => \n              <div style={{\n                display: 'flex',\n                flexDirection: 'column',\n                justifyContent: 'flex-start',\n                width: 200,\n                margin: 30,\n              }}>\n                <div\n                  style={{\n                    position: 'relative',\n                    backgroundColor: 'rgba(50, 50, 0, 0.5)',\n                  }}\n                  >\n                  <img\n                    alt={'back' + idx}\n                    src={Skeleton}\n                    width={200}\n                    height={200}\n                    style={{\n                      backgroundColor: 'rgba(50, 50, 0, 0.5)',\n                      zIndex: -1,\n                    }}\n                  />\n                </div>\n                <MintButton\n                  disabled={true}\n                  onClick={onMint}\n                  variant=\"contained\"\n                >\n                  MINT\n                </MintButton>\n              </div>\n            )}\n          </div>\n          </>\n        ) : \n        <div style={{\n          width: '100%',\n          display: 'flex',\n          flexDirection: 'row',\n          flexWrap: 'wrap',\n          justifyContent: 'center',\n          maxWidth: 1100\n        }}\n        >\n          {curItems.map((item, idx) => \n            <div style={{\n              display: 'flex',\n              flexDirection: 'column',\n              justifyContent: 'flex-start',\n              width: 200,\n              margin: 30,\n            }}>\n              <div\n                style={{\n                  position: 'relative',\n                  backgroundColor: 'rgba(50, 50, 0, 0.5)',\n                }}\n                >\n                <img\n                  alt={'' + idx}\n                  src={\"https://placeimg.com/200/200/\"+idx}\n                  style={{\n                    minWidth: 200,\n                    minHeight: 200,\n                    zIndex: 1,\n                  }}\n                />\n                <img\n                  alt={'back' + idx}\n                  src={Skeleton}\n                  width={200}\n                  height={200}\n                  style={{\n                    position: 'absolute',\n                    top: 0,\n                    left: 0,\n                    backgroundColor: 'rgba(50, 50, 0, 0.5)',\n                    zIndex: -1,\n                  }}\n                />\n              </div>\n              <MintButton\n                disabled={isSoldOut || isMinting || !isActive}\n                onClick={onMint}\n                variant=\"contained\"\n              >\n                {isSoldOut ? (\n                  \"SOLD OUT\"\n                ) : isActive ? (\n                  isMinting ? (\n                    <CircularProgress />\n                  ) : (\n                    \"MINT\"\n                  )\n                ) : (\n                  <Countdown\n                    date={startDate}\n                    onMount={({ completed }) => completed && setIsActive(true)}\n                    onComplete={() => setIsActive(true)}\n                    renderer={renderCounter}\n                  />\n                )}\n              </MintButton>\n            </div>\n          )}\n        </div>\n        }\n      </MintContainer>\n\n      <Snackbar\n        open={alertState.open}\n        autoHideDuration={6000}\n        onClose={() => setAlertState({ ...alertState, open: false })}\n      >\n        <Alert\n          onClose={() => setAlertState({ ...alertState, open: false })}\n          severity={alertState.severity}\n        >\n          {alertState.message}\n        </Alert>\n      </Snackbar>\n    </main>\n  );\n};\n\ninterface AlertState {\n  open: boolean;\n  message: string;\n  severity: \"success\" | \"info\" | \"warning\" | \"error\" | undefined;\n}\n\nconst renderCounter = ({ days, hours, minutes, seconds, completed }: any) => {\n  return (\n    <CounterText>\n      {hours + (days || 0) * 24} hours, {minutes} minutes, {seconds} seconds\n    </CounterText>\n  );\n};\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}